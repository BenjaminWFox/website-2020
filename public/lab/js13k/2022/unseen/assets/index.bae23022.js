let t,e,i=()=>{},n={};function s(t,...e){(n[t]||[]).map((t=>t(...e)))}let a={get:(t,e)=>"_proxy"==e||i};function o(){return t}function h(){return e}class r{constructor({spriteSheet:t,frames:e,frameRate:i,loop:n=!0}){this.spriteSheet=t,this.frames=e,this.frameRate=i,this.loop=n;let{width:s,height:a,margin:o=0}=t.frame;this.width=s,this.height=a,this.margin=o,this._f=0,this._a=0}clone(){return new r(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:e,width:i=this.width,height:n=this.height,context:s=h()}){let a=this.frames[this._f]/this.spriteSheet._f|0,o=this.frames[this._f]%this.spriteSheet._f|0;s.drawImage(this.spriteSheet.image,o*this.width+(2*o+1)*this.margin,a*this.height+(2*a+1)*this.margin,this.width,this.height,t,e,i,n)}}function c(){return new r(...arguments)}function d(t,e,i){return Math.min(Math.max(t,i),e)}class l{constructor(t=0,e=0,i={}){this.x=t,this.y=e,i._c&&(this.clamp(i._a,i._b,i._d,i._e),this.x=t,this.y=e)}add(t){return new l(this.x+t.x,this.y+t.y,this)}subtract(t){return new l(this.x-t.x,this.y-t.y,this)}scale(t){return new l(this.x*t,this.y*t)}normalize(t=this.length()){return new l(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}clamp(t,e,i,n){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=n}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?d(this._a,this._d,t):t}set y(t){this._y=this._c?d(this._b,this._e,t):t}}function g(){return new l(...arguments)}class u extends class{constructor(t){return this.init(t)}init(t={}){this.position=g(),this.velocity=g(),this.acceleration=g(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let e=this.acceleration;t&&(e=e.scale(t)),this.velocity=this.velocity.add(e);let i=this.velocity;t&&(i=i.scale(t)),this.position=this.position.add(i),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}{init({width:t=0,height:e=0,context:i=h(),render:n=this.draw,update:s=this.advance,children:a=[],anchor:o={x:0,y:0},opacity:r=1,rotation:c=0,scaleX:d=1,scaleY:l=1,...g}={}){this._c=[],super.init({width:t,height:e,context:i,anchor:o,opacity:r,rotation:c,scaleX:d,scaleY:l,...g}),this._di=!0,this._uw(),this.addChild(a),this._rf=n,this._uf=s}update(t){this._uf(t),this.children.map((e=>e.update&&e.update(t)))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),1==this.scaleX&&1==this.scaleY||t.scale(this.scaleX,this.scaleY);let e=-this.width*this.anchor.x,i=-this.height*this.anchor.y;(e||i)&&t.translate(e,i),this.context.globalAlpha=this.opacity,this._rf(),(e||i)&&t.translate(-e,-i),this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:e=0,_wo:i=1,_wr:n=0,_wsx:s=1,_wsy:a=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=i*this.opacity,this._wsx=s*this.scaleX,this._wsy=a*this.scaleY,this._wx=this._wx*s,this._wy=this._wy*a,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=n+this.rotation;let{x:o,y:h}=((t,e)=>{let i=Math.sin(e),n=Math.cos(e);return{x:t.x*n-t.y*i,y:t.x*i+t.y*n}})({x:this._wx,y:this._wy},n);this._wx=o,this._wy=h,this._wx+=t,this._wy+=e}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map((t=>{this.children.push(t),t.parent=this,t._pc=t._pc||i,t._pc()}))}removeChild(...t){t.flat().map((t=>{((t,e)=>{let i=t.indexOf(e);if(-1!=i)return t.splice(i,1),!0})(this.children,t)&&(t.parent=null,t._pc())}))}get opacity(){return this._opa}set opacity(t){this._opa=t,this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,e=t){this.scaleX=t,this.scaleY=e}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}class p extends u{init({image:t,width:e=(t?t.width:void 0),height:i=(t?t.height:void 0),...n}={}){super.init({image:t,width:e,height:i,...n})}get animations(){return this._a}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){super.advance(t),this.currentAnimation&&this.currentAnimation.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}let m=/(\d+)(\w+)/;class w extends u{init({text:t="",textAlign:e="",lineHeight:i=1,font:n=h().font,...s}={}){t=""+t,super.init({text:t,textAlign:e,lineHeight:i,font:n,...s}),this._p()}get width(){return this._w}set width(t){this._d=!0,this._w=t,this._fw=t}get text(){return this._t}set text(t){this._d=!0,this._t=""+t}get font(){return this._f}set font(t){this._d=!0,this._f=t,this._fs=(t=>{let e=t.match(m),i=+e[1];return{size:i,unit:e[2],computed:i}})(t).computed}get lineHeight(){return this._lh}set lineHeight(t){this._d=!0,this._lh=t}render(){this._d&&this._p(),super.render()}_p(){this._s=[],this._d=!1;let t=this.context;if(t.font=this.font,!this._s.length&&this._fw){let e=this.text.split(" "),i=0,n=2;for(;n<=e.length;n++){let s=e.slice(i,n).join(" ");t.measureText(s).width>this._fw&&(this._s.push(e.slice(i,n-1).join(" ")),i=n-1)}this._s.push(e.slice(i,n).join(" "))}if(!this._s.length&&this.text.includes("\n")){let e=0;this.text.split("\n").map((i=>{this._s.push(i),e=Math.max(e,t.measureText(i).width)})),this._w=this._fw||e}this._s.length||(this._s.push(this.text),this._w=this._fw||t.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}draw(){let t=0,e=this.textAlign,i=this.context;e=this.textAlign||("rtl"==i.canvas.dir?"right":"left"),t="right"==e?this.width:"center"==e?this.width/2|0:0,this._s.map(((n,s)=>{i.textBaseline="top",i.textAlign=e,i.fillStyle=this.color,i.font=this.font,i.fillText(n,t,this._fs*this.lineHeight*s)}))}}function y(){return new w(...arguments)}let f=new WeakMap,x={},A={},E={0:"left",1:"middle",2:"right"};function _(t,e){let{x:i,y:n,width:s,height:a}=(t=>{let{x:e=0,y:i=0,width:n,height:s}=t.world||t;return t.mapwidth&&(n=t.mapwidth,s=t.mapheight),t.anchor&&(e-=n*t.anchor.x,i-=s*t.anchor.y),0>n&&(e+=n,n*=-1),0>s&&(i+=s,s*=-1),{x:e,y:i,width:n,height:s}})(t);do{i-=t.sx||0,n-=t.sy||0}while(t=t.parent);let o=e.x-Math.max(i,Math.min(e.x,i+s)),h=e.y-Math.max(n,Math.min(e.y,n+a));return o*o+h*h<e.radius*e.radius}function b(t,e){return parseFloat(t.getPropertyValue(e))||0}function I(t){let e=null!=t.button?E[t.button]:"left";A[e]=!0,C(t,"onDown")}function S(t){let e=null!=t.button?E[t.button]:"left";A[e]=!1,C(t,"onUp")}function M(t){C(t,"onOver")}function v(t){f.get(t.target)._oo=null,A={}}function B(t,e,i){let n=(t=>{let e=t._lf.length?t._lf:t._cf;for(let i=e.length-1;i>=0;i--){let n=e[i];if(n.collidesWithPointer?n.collidesWithPointer(t):_(n,t))return n}})(t);n&&n[e]&&n[e](i),x[e]&&x[e](i,n),"onOver"==e&&(n!=t._oo&&t._oo&&t._oo.onOut&&t._oo.onOut(i),t._oo=n)}function C(t,e){t.preventDefault();let i=t.target,n=f.get(i),{scaleX:a,scaleY:o,offsetX:h,offsetY:r}=(t=>{let{canvas:e,_s:i}=t,n=e.getBoundingClientRect(),s="none"!=i.transform?i.transform.replace("matrix(","").split(","):[1,1,1,1],a=parseFloat(s[0]),o=parseFloat(s[3]),h=(b(i,"border-left-width")+b(i,"border-right-width"))*a,r=(b(i,"border-top-width")+b(i,"border-bottom-width"))*o,c=(b(i,"padding-left")+b(i,"padding-right"))*a,d=(b(i,"padding-top")+b(i,"padding-bottom"))*o;return{scaleX:(n.width-h-c)/e.width,scaleY:(n.height-r-d)/e.height,offsetX:n.left+(b(i,"border-left-width")+b(i,"padding-left"))*a,offsetY:n.top+(b(i,"border-top-width")+b(i,"padding-top"))*o}})(n);t.type.includes("touch")?(Array.from(t.touches).map((({clientX:t,clientY:e,identifier:i})=>{let s=n.touches[i];s||(s=n.touches[i]={start:{x:(t-h)/a,y:(e-r)/o}},n.touches.length++),s.changed=!1})),Array.from(t.changedTouches).map((({clientX:i,clientY:c,identifier:d})=>{let l=n.touches[d];l.changed=!0,l.x=n.x=(i-h)/a,l.y=n.y=(c-r)/o,B(n,e,t),s("touchChanged",t,n.touches),"onUp"==e&&(delete n.touches[d],n.touches.length--,n.touches.length||s("touchEnd"))}))):(n.x=(t.clientX-h)/a,n.y=(t.clientY-r)/o,B(n,e,t))}function R(t){let e=t.canvas;t.clearRect(0,0,e.width,e.height)}let Q={},D={},k={},Y={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function L(t=i,e){t._pd&&e.preventDefault(),t(e)}function U(t){let e=Y[t.code],i=Q[e];k[e]=!0,L(i,t)}function H(t){let e=Y[t.code],i=D[e];k[e]=!1,L(i,t)}function T(){k={}}function j(t){if(+t==t)return t;let e=[],i=t.split(".."),n=+i[0],s=+i[1],a=n;if(s>n)for(;s>=a;a++)e.push(a);else for(;a>=s;a--)e.push(a);return e}class G{constructor({image:t,frameWidth:e,frameHeight:i,frameMargin:n,animations:s}={}){if(!t)throw Error("You must provide an Image for the SpriteSheet");this.animations={},this.image=t,this.frame={width:e,height:i,margin:n},this._f=t.width/e|0,this.createAnimations(s)}createAnimations(t){let e,i;for(i in t){let{frames:n,frameRate:s,loop:a}=t[i];if(e=[],null==n)throw Error("Animation "+i+" must provide a frames property");[].concat(n).map((t=>{e=e.concat(j(t))})),this.animations[i]=c({spriteSheet:this,frames:e,frameRate:s,loop:a})}}}function O(){return new G(...arguments)}const K={money:0,highScore:0,earned:0,breaks:0,plays:0,coil:!1,purchases:{}};function P(){const t=JSON.parse(window.localStorage.getItem("js13k22-unseen-stats")||JSON.stringify(K));return console.log("GOT STATS",t),t}function W(t){const e=P(),i={...e,...t};i.highScore=t.highScore&&t.highScore>e.highScore?t.highScore:e.highScore,t.purchases&&(i.purchases={...e.purchases,...t.purchases}),console.log("SETTING STATS",i),window.localStorage.setItem("js13k22-unseen-stats",JSON.stringify(i))}class F extends p{constructor(t){super(t),this.enabled=!1===t.enabled||!0}goTo(t){this.destination=t}isAt(){if(!this.destination)return!1;const t=(e=this.destination,Math.atan2(e.y-this.y,e.x-this.x)+Math.PI/2);var e;const i=((t,e,i)=>({x:t.x+Math.sin(e)*i,y:t.y-Math.cos(e)*i}))({x:this.x,y:this.y},t,-1.66*z.scrollSpeed);return this.x=i.x,this.y=i.y,Math.abs(this.x-this.destination.x)<-2*z.scrollSpeed&&Math.abs(this.y-this.destination.y)<-2*z.scrollSpeed}get isMoving(){return!!this.destination}}let{canvas:N,context:J}=((i,{contextless:n=!1}={})=>{if(t=document.getElementById(i)||i||document.querySelector("canvas"),n&&(t=t||new Proxy({},a)),!t)throw Error("You must provide a canvas element for the game");return e=t.getContext("2d")||new Proxy({},a),e.imageSmoothingEnabled=!1,s("init"),{canvas:t,context:e}})();function X(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function q(t,e,i,n=0){if(!t.enabled||!e.enabled)return!1;const s=i?.75:0,a=e.x>t.x+t.width+n,o=e.x+e.width<t.x-n+t.width*s;if(a||o)return!1;const h=e.y+e.height<t.y-n,r=e.y>t.y+t.height+n;return!h&&!r}function Z(){let t=N.width;const e=N.height,i=-t/250,n=t/250;return N.width=t,N.height=e,{playing:!1,menuing:!0,ending:!1,shopping:!1,ratio:1,width:t,height:e,maxDyUp:i,maxDyDown:n,maxDyUpChange:Math.abs(.05*i),maxDyDownChange:Math.abs(.05*i),objectives:[],obstacles:[],birdStartX:300,birdStartY:e/2,birdStartDy:-12,distance:1,pickups:0,canvas:N,context:J,baseSpeed:-7,scrollSpeed:-3,font:"32px Arial",maxY:e-30,minY:30,taper:.05,lastObstacleSpawn:0,canSpawnObstacle:!1,hitboxOffset:30,brokenWindowsInRun:0,powerups:{life:0,money:0,magnate:0,agile:!1,sabotage:!1,civics:!1}}}let z={...Z(),setPlaying(){},setEnding(){},setMenuing(){},setShopping(){}};function V(){const t=P();z={...Z(),setPlaying(){console.log("SIP"),z.playing=!0,z.ending=!1,z.menuing=!1,z.shopping=!1},setEnding(){z.playing=!1,z.ending=!0,z.menuing=!1,z.shopping=!1},setMenuing(){z.playing=!1,z.ending=!1,z.menuing=!0,z.shopping=!1},setShopping(){z.playing=!1,z.ending=!1,z.menuing=!1,z.shopping=!0}},t.purchases.neck&&(z.powerups.life+=1),t.purchases.steel&&(z.powerups.life+=2),t.purchases.money&&(z.powerups.money=20),t.purchases.magnate&&(z.powerups.magnate=100),t.purchases.sabotage&&(z.powerups.sabotage=!0),t.purchases.civics&&(z.powerups.civics=!0),t.purchases.agile&&(console.log("AGILE!"),z.powerups.agile=!0,z.maxDyUp=-z.width/150,z.maxDyDown=z.width/150,z.maxDyUpChange=Math.abs(.025*z.maxDyUp),z.maxDyDownChange=Math.abs(.025*z.maxDyUp),z.birdStartDy=-10)}V();const $="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAOAQAAAAAQnZGUAAAALklEQVR4AWP4////H4YHDAwyEKKBvYGFoYHDAUgIKAAJYQgB5kIkwEoQOsAGAACN+RJn1qrzCgAAAABJRU5ErkJggg==",tt=[];let et,it,nt,st,at,ot;const ht=z.birdStartX;function rt(t,e){return new F({x:t,y:e,width:30,height:14,dy:0,dx:z.scrollSpeed,image:st,enabled:!0})}class ct{constructor(t,e,i){this.fn=t,this.yMin=e,this.yMax=i}function(t){const e=t||X(this.yMin,this.yMax);return t=>this.fn(t,e)}}const dt=new ct(((t,e)=>e*z.ratio+100*z.ratio*Math.sin(1*Math.PI*t+3)),50,750),lt=new ct(((t,e)=>e*z.ratio+150*z.ratio*Math.sin(1*Math.PI*t+3)),50,750),gt=new ct(((t,e)=>e*z.ratio-25*z.ratio*Math.sin(2.5*Math.PI*t*.1+3)),100,700),ut=new ct(((t,e)=>e*z.ratio+115*z.ratio*Math.sin(.1*Math.PI*t+3)),170,610),pt=new ct(((t,e)=>e*z.ratio+100*z.ratio*Math.sin(.125*Math.PI*t+0)),300,490),mt=new ct(((t,e)=>e*z.ratio+150*z.ratio*Math.sin(.04*Math.PI*t+3)),170,740),wt=new ct(((t,e)=>e*z.ratio+150*z.ratio*Math.sin(2.952*Math.PI*t+0)),170,610),yt=new ct(((t,e)=>e*z.ratio+50*z.ratio*Math.sin(2.94*Math.PI*t+0)),70,710),ft=[dt,lt,gt,ut,pt,mt,wt,yt];function xt(t,e){const i=t||1.25*z.width,n=.5>Math.random()?21:26;let s=ft[X(0,ft.length-1)].function();for(let a=0;n>a;a+=1){const t=i+60*a,n=e?e(a):s(a);z.objectives.push(rt(t,n))}}const At=z.height-155-20*z.ratio,Et=20*z.ratio;function _t(t,e){const i=new F({x:t,y:e,width:45,height:155,dy:0,dx:z.scrollSpeed,animations:ot?.animations,enabled:!0});return i?i.playAnimation("whole"):console.log("S not found O.o",i),i}const bt=new AudioContext;function It(...t){return((...t)=>{const e=bt.createBuffer(t.length,t[0].length,44100),i=bt.createBufferSource();return t.map(((t,i)=>e.getChannelData(i).set(t))),i.buffer=e,i.connect(bt.destination),i.start(),i})(((t=1,e=.05,i=220,n=0,s=0,a=.1,o=0,h=1,r=0,c=0,d=0,l=0,g=0,u=0,p=0,m=0,w=0,y=1,f=0,x=0)=>{const A=2*Math.PI;let E,_,b=44100,I=r*=500*A/b/b,S=i*=(1+2*e*Math.random()-e)*A/b,M=[],v=0,B=0,C=0,R=1,Q=0,D=0,k=0;for(c*=500*A/b**3,p*=A/b,d*=A/b,l*=b,g=g*b|0,_=(n=n*b+9)+(f*=b)+(s*=b)+(a*=b)+(w*=b)|0;_>C;M[C++]=k)++D%(100*m|0)||(k=o?o>1?o>2?o>3?Math.sin((v%A)**3):Math.max(Math.min(Math.tan(v),1),-1):1-(2*v/A%2+2)%2:1-4*Math.abs(Math.round(v/A)-v/A):Math.sin(v),k=(g?1-x+x*Math.sin(A*C/g):1)*(k>0?1:-1)*Math.abs(k)**h*t*.3*(n>C?C/n:n+f>C?1-(C-n)/f*(1-y):n+f+s>C?y:_-w>C?(_-C-w)/a*y:0),k=w?k/2+(w>C?0:(_-w>C?1:(_-C)/w)*M[C-w|0]/2):k),E=(i+=r+=c)*Math.cos(p*B++),v+=E-E*u*(1-1e9*(Math.sin(C)+1)%2),R&&++R>l&&(i+=d,S+=d,R=0),!g||++Q%g||(i=S,r=I,R=R||1);return M})(...t))}class St{constructor(t,e,i,n,s){this.id=t,this.title=e,this.desc=i,this.cost=n,this.purchased=s}}const Mt=[new St("neck","Neck Brace","Adds 1 extra life per round!",100,!1),new St("steel","Steel Tipped Beak","Adds 2 extra lives per round!",200,!1),new St("money","Money Magnet","Much larger pickup radius!",500,!1),new St("agile","Agility Training","Better, stronger, faster! More responsive bird.",800,!1),new St("sabotage","Sabotage Glass Supply","Easy-break glass! 50% chance to avoid death.",1500,!1)],vt=[new St("magnate","Money Magnate (coil)","Absurd Pickup Radius!",1e3,!1),new St("civics","Bribe City Council (coil)","Hi-viz Window Coatings! 50% chance to dodge windows.",1500,!1)];function Bt(){console.log("dollarImg",st);const t=document.getElementById("available");if(t){const e=P().money;t.innerHTML=`You have ${e} <span id="available-img"></span> available!`,document.getElementById("available-img")?.appendChild(st.cloneNode())}}function Ct(){const t=document.getElementById("items"),e=document.getElementById("buy"),i=P();t.innerHTML="",Mt.forEach((n=>{const s=i.purchases[n.id],a=document.createElement("button"),o=document.createElement("div");a.classList.add("item"),a.innerHTML=n.title,o.innerHTML=n.cost.toString(),o.classList.add("itemAmount");const h=document.createElement("img");h.src=$,o.append(h),a.appendChild(o),s&&a.classList.add("owned"),a.addEventListener("click",(()=>{e.setAttribute("data-id",n.id),st.setAttribute("data-id",n.id),s?e.innerHTML=`${n.desc} You already own this!`:(e.innerHTML=`${n.desc} Click here to buy for ${n.cost}`,e.appendChild(st)),a.id=n.id,a.style.border="1px #fff solid"})),t.appendChild(a)}))}const Rt=()=>It(...[.5,,150,,.08,.13,4,2.84,.1,,,,.07,1.7,,.1,.09,.8,.08,.2]);let Qt,Dt;function kt(){let t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`);const e=document.getElementById("wrapper");e&&(e.style.maxWidth=`${z.canvas.offsetWidth}px`,e.style.minWidth=`${z.canvas.offsetWidth}px`,e.style.height=`${z.canvas.offsetHeight}px`,e.style.left=`${z.canvas.offsetLeft}px`,e.style.top=`${z.canvas.offsetTop}px`)}function Yt(t,e,i="block"){const n=document.getElementById(t);n&&(n.style.display=e?i:"none")}function Lt(t,e){const i=document.createElement("p");i.classList.add("stat"),i.innerHTML=e,t.appendChild(i)}function Ut(){const t=P(),e=document.getElementById("statItems");e.innerHTML="",Lt(e,`High Score:<br/>${t.highScore}`),Lt(e,`Times Played:<br/>${t.plays}`),Lt(e,`Money Earned:<br/>${t.earned}`),Lt(e,`Windows Broken:<br/>${t.breaks}`)}function Ht(t){Object.keys(t).forEach((e=>{"y"===e?(it.y=t.y-z.hitboxOffset,et.y=t.y):(it[e]=t[e],et[e]=t[e])}))}window.addEventListener("resize",(()=>{console.log("RESIZE"),kt()})),window.addEventListener("fullscreenchange",(()=>{console.log("FULLSCREEN"),kt()})),document.monetization?(document.monetization.addEventListener("monetizationpending",(()=>console.log("hi"))),document.monetization.addEventListener("monetizationstart",(()=>{const t=P(),e=document.getElementById("coilMain"),i=document.getElementById("coilNew");e.style.display="block",vt.forEach((t=>Mt.push(t))),t.coil?i.style.display="none":W({coil:!0,money:t.money+600,earned:t.earned+600})}))):console.log("No monetization"),window.addEventListener("load",(()=>{console.log("load"),kt(),(()=>{const t=document.getElementById("playBtn"),e=document.getElementById("shopBtn"),i=document.getElementById("statBtn"),n=document.getElementById("fs");Ut(),t?.addEventListener("click",(()=>{Yt("wrapper",!1),Yt("store",!1),Yt("stats",!1),V(),Ht({x:z.birdStartX,y:z.birdStartY,dy:z.birdStartDy,dx:0}),it.playAnimation("fly"),z.setPlaying(),Ft.start(),xt(1.5*z.width,dt.function(390)),(()=>{const t=z.width,e=z.height/2+77.5,i=1.35*z.width,n=z.height/2-232.5;z.obstacles.push(_t(t,e)),z.obstacles.push(_t(i,n))})(),Qt=rt(25,54),Dt=new F({image:nt,x:25,y:76,width:30,height:14,enabled:!0})})),e?.addEventListener("click",(()=>{z.setShopping(),Ct(),z.context.clearRect(0,0,z.canvas.width,z.canvas.height),Yt("store",!0,"flex"),Yt("stats",!1),Bt()})),i?.addEventListener("click",(()=>{z.setShopping(),z.context.clearRect(0,0,z.canvas.width,z.canvas.height),Yt("store",!1,"flex"),Yt("stats",!0),Ut()})),n?.addEventListener("click",(()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}))})(),(()=>{let t;for(t=0;26>t;t++)Y["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;10>t;t++)Y["Digit"+t]=Y["Numpad"+t]=""+t;window.addEventListener("keydown",U),window.addEventListener("keyup",H),window.addEventListener("blur",T)})(),(({radius:t=5,canvas:e=o()}={})=>{let i=f.get(e);if(!i){let n=window.getComputedStyle(e);i={x:0,y:0,radius:t,touches:{length:0},canvas:e,_cf:[],_lf:[],_o:[],_oo:null,_s:n},f.set(e,i)}var s;e.addEventListener("mousedown",I),e.addEventListener("touchstart",I),e.addEventListener("mouseup",S),e.addEventListener("touchend",S),e.addEventListener("touchcancel",S),e.addEventListener("blur",v),e.addEventListener("mousemove",M),e.addEventListener("touchmove",M),i._t||(i._t=!0,s=()=>{i._lf.length=0,i._cf.map((t=>{i._lf.push(t)})),i._cf.length=0},n.tick=n.tick||[],n.tick.push(s))})()}));const Tt=y({text:"",font:`${z.font}`,color:"white",x:20,y:20,textAlign:"left",anchor:{x:0,y:0}}),jt=y({text:"",font:"20px Arial",color:"white",x:60,y:52,textAlign:"left",anchor:{x:0,y:0}}),Gt=y({text:"0",font:"20px Arial",color:"white",x:60,y:75,textAlign:"left",anchor:{x:0,y:0}});function Ot(t){return q(et,t,!1,15+z.powerups.money+z.powerups.magnate)}function Kt(t){return z.playing&&q(et,t,!0,-2)}function Pt(t){z.powerups.civics&&X(0,9)>=5?(console.log("Barrel roll!"),It(...[.25,,259,.04,.06,.09,,.25,12,,,,,.7,,,,.86,.1]),t.enabled=!1):z.powerups.sabotage&&X(0,9)>=5?(console.log("Not today!"),Rt(),t.enabled=!1,t.playAnimation("break"),z.brokenWindowsInRun+=1):z.powerups.life>0?(console.log("Oh, ouch!"),z.powerups.life-=1,t.enabled=!1,Rt(),t.playAnimation("break"),z.brokenWindowsInRun+=1):(console.log("Ahh dangit!"),z.setEnding(),Ht({dx:z.scrollSpeed/5}),it.playAnimation("hit"),It(...[.5,0,222,.02,.1,.11,4,.45,-1.5,,,,,2,,.2,,.61,.2,.11]),t.playAnimation("break"),z.brokenWindowsInRun+=1)}let Wt=0;let Ft=function({fps:t=60,clearCanvas:e=!0,update:n=i,render:a,context:o=h(),blur:r=!1}={}){if(!a)throw Error("You must provide a render() function");let c,d,l,g,u,p=0,m=1e3/t,w=1/t,y=e?R:i,f=!0;function x(){if(d=requestAnimationFrame(x),f&&(l=performance.now(),g=l-c,c=l,1e3>=g)){for(s("tick"),p+=g;p>=m;)u.update(w),p-=m;y(o),u.render()}}return r||(window.addEventListener("focus",(()=>{f=!0})),window.addEventListener("blur",(()=>{f=!1}))),u={update:n,render:a,isStopped:!0,start(){c=performance.now(),this.isStopped=!1,requestAnimationFrame(x)},stop(){this.isStopped=!0,cancelAnimationFrame(d)},_frame:x,set _last(t){c=t}},u}({update(){z.playing?(z.scrollSpeed=z.baseSpeed+z.baseSpeed*(z.distance/5e3),z.distance+=1):z.ending&&(0>z.scrollSpeed&&(z.scrollSpeed=Math.min(z.scrollSpeed+z.taper,0)),et.dx>0&&Ht({dx:Math.max(et.dx-z.taper,0)})),(z.playing||z.ending)&&((()=>{for(let t=0;t<z.objectives.length;t+=1){const e=z.objectives[t];e.x<0-e.width?(z.objectives.splice(t,1),t-=1):Ot(e)?(z.pickups+=1,e.enabled=!1,e.goTo(et)):(e.isMoving&&e.isAt()&&(z.objectives.splice(t,1),t-=1,It(...[.25,,4,.01,,.09,1,1.39,-41,-1.7,,,,,3,,.01,.41,.04])),e.dx!==z.scrollSpeed&&(e.dx=z.scrollSpeed),e.update())}z.objectives.length&&z.objectives.at(-1).x<z.width&&xt()})(),(()=>{for(let t=0;t<z.obstacles.length;t+=1){const e=z.obstacles[t];e.x<0-e.width?(z.obstacles.splice(t,1),t-=1):(Kt(e)&&Pt(e),e.dx!==z.scrollSpeed&&(e.dx=z.scrollSpeed),e.update())}z.distance-z.lastObstacleSpawn>50&&z.distance%25==0&&(z.canSpawnObstacle=!0),z.canSpawnObstacle&&40===X(1,40)&&(z.canSpawnObstacle=!1,z.lastObstacleSpawn=z.distance,(()=>{let t=_t(z.width+180*z.ratio,X(Et,At));z.objectives.forEach((e=>{if(q(e,t,!1,.5*e.width*z.ratio))for(;q(e,t,!1,.5*e.width*z.ratio);)t.y-=20*z.ratio,t.y<Et&&(t.y=At)})),z.obstacles.push(t)})())})(),(k.space||A.left||((t=o())=>f.get(t))().touches.length>0)&&et.dy>z.maxDyUp&&(z.playing||et.dx>2)?Ht({dy:et.dy-z.maxDyUpChange}):et.dy<z.maxDyDown&&Ht({dy:et.dy+z.maxDyDownChange}),et.y>z.maxY?Ht({y:z.maxY,dy:0}):et.y<z.minY&&Ht({y:z.minY,dy:0}),0>et.dx?et.dx+=.011:(et.dx=0,et.x=Math.round(et.x)),z.ending&&et.y===z.maxY&&(()=>{const t=P();it.playAnimation("stop"),It(...[1,0,5,,.28,.07,2,.17,,,,,.01,.4,,.9,.15,.24,.07,.05]),W({money:t.money+z.pickups,earned:t.earned+z.pickups,plays:t.plays+1,breaks:t.breaks+z.brokenWindowsInRun,highScore:z.distance}),Yt("wrapper",!0),z.setMenuing()})(),z.playing&&(20===Wt?(It(...[.05,,562,.04,,.07,4,.26,6.4,,88,.22,,,4.8,.2,,.26,.01]),Wt=0):Wt+=1),et.update(),it.update()),z.menuing},render(){z.shopping||(it.render(),z.objectives.forEach((t=>{t.render()})),z.obstacles.forEach((t=>{t.render()})),et.render(),Tt.text=`${String(z.distance).padStart(5,"0")}m`,jt.text=`${z.pickups}`,Gt.text=z.powerups.life.toString(),Tt.render(),jt.render(),Qt.render(),Gt.render(),Dt.render())}});(()=>{console.log("SETUP STORE! Do not call this more than once...");const t=document.getElementById("items"),e=document.getElementById("buy");t&&e&&(e.addEventListener("click",(t=>{const i=P(),n=t.target.getAttribute("data-id")||"",s=Mt.filter((t=>t.id===n))[0],a=document.getElementById(n);if(i.money<s.cost||i.purchases[n]){const t=document.getElementById("available");t.style.animationName="emphasize",setTimeout((()=>{t.style.animationName=""}),400)}else{if(W({money:i.money-s.cost,purchases:{[s.id]:s.id}}),a){a.classList.add("owned");const t=a.cloneNode(!0);a.parentNode?.replaceChild(t,a),e.innerHTML=`${s.desc} You already own this!`,e.setAttribute("data-id",s.id),t.addEventListener("click",(()=>{e.innerHTML=`${s.desc} You already own this!`,e.setAttribute("data-id",s.id)}))}Bt()}})),Ct())})(),(t=>{function e(t){tt.push(t),tt.length}et=new F({x:z.birdStartX,y:z.birdStartY,width:65,height:65/4,dy:z.birdStartDy,enabled:!0});const i=new Image;i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAooAAABBCAMAAABhGnXgAAAACVBMVEX///8AAAD///9+749PAAAAA3RSTlP//wDXyg1BAAADxklEQVR42u2dgW6jMBBEn/3/H92gJLdtwFnMXMByZoQq1dVOB+/DDZASqmUNIdYjPDdjal2JIqXE9gKn2bTOQ5HySzyGeMJpFq2zUKT8ES9jXhitk1Ck/BWvY379aF2DYuE+5nXRuh5FXga8LlpjoFh86mJdgmLBKFpjoFiMomUULV9XNIrWgCgWOkmE6jvYVnBwEYrw7z4h4f2IZDynlc6BjuKqnPWdGSrLMBQvltNK54DawWKK4ja2ECN+rTmLZA4EFFMS2Y6AT3smls5BjmKInSA1LodTfBd7Yukc5CiGEFC8O/rdPV+PYsKBimJazDLoK5NfIJ0DEhsRxYJJNIoZBzmKIVrlea1RNIqLRBRD7EXRN7GthAMRxcJhFAtG0SjexAkoZsW+sGgWFyGhGOI4igWTaBRTDkhsQhxHsXAMRSrcv9zkhwKcp7wLIgc6iscz0I8iFZZfy70EFptqHE+Q0IWcAx3FgoBiHBB0TEEU8/wG36w5RXkXZA4UFAFqrQB0ZogdIQySKWgdTyQGuWxQP9AFlQP2uUDoMZBm6DcIsWGTGCQCbPDBLugc8D5AVK0E7QiCQbYjK4NEqwAgGhTVgHJ5AsQufIIDGgdDuzJ2BaCRQTHIz8Fyg2iAbrASOw1oGKAn0AyQu/AJDkhW5kywGUEwaE1Cs7HtXdgK0WPAduL9Bg1xQgJhDoQuKByQJEiqtwyAwwaRgFd1GjTmvNBhkICQGeQo6gn0OdC7oHPQdhAoHsyAdVWPwWYQdhvQSq4mUOdgyDaSvLTJ/6wObQCvTaDPoEVCbpCgqCUQ52DINlIr70o3BFBDgxvwe6PQYdCkidwgYVFOIM3BmG2kJpXpejy6AcRGtwENy8IuA9qZ9ATCHIzYRuiqT66Iw3QGtPBgjwFNvNATMFkXaFxHT+pD/OF8PgPegJAbkKAoJZisC5XgMPgE9p8pxY9nM0hByA1IUFQSzNUFmvfFSTgORf2MBm0S2GVAgqKUYKYu8M45JPxr9oUG/8mAJgi5IFkWtQQzdYGPP1FqAoMDIIQSFLUEM3WB+lHBDAYoIFQSFJUEE3XB784/BBOlC6UMRT3B+DKKRtEoGsWURaNoFKuOIpejiFH0EwNvoqKjKCQAKkbRj/Qthb6ZQ0exsjoSjOJXCulpK/qyGAkCxWoUv1HwYIGrUIwERvHbdWehUg6cMaCjGAkwitbxT41DQnGdoBpFS74e5If/GMWrUfTn1xjFEYRRNIpjCH+QklEcRHhNNIpjCK+JRnGkGzbLZhKN4rWCZcOPt2/oByhuH7Wcf88VAAAAAElFTkSuQmCC",i.width=650,i.height=65,i.onload=()=>{let t=O({image:i,frameWidth:65,frameHeight:65,animations:{fly:{frames:"0..9",frameRate:30},stop:{frames:"3"},hit:{frames:"0"}}});it=new F({x:ht,y:et.y-z.hitboxOffset,animations:t.animations,enabled:!0}),e(i)},st=new Image,st.src=$,st.width=30,st.height=14,st.onload=()=>{e(st)},nt=new Image,nt.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAOCAYAAAA45qw5AAAAWUlEQVR4Ab2SgQaAQBQE5/9/ukRgylXbesPA4c3iALYD4LUn/BEdGw37aBBNw1Iswlei8FceRrMSHUqMBtAO+d2Uw8HAqZBhIMadDHyoflgoWA4LUgmCNNwBzMdwutSvVBcAAAAASUVORK5CYII=",nt.width=30,nt.height=14,nt.onload=()=>{e(nt)},at=new Image,at.src="data:image/png;base64,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",at.width=270,at.height=155,at.onload=()=>{ot=O({frameWidth:45,frameHeight:155,animations:{break:{frames:"0..5",frameRate:30,loop:!1},whole:{frames:"0",frameRate:1}},image:at}),e(at)}})();
